<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>View Bill </title>
  <link rel="icon" href="/images/weldon-paints-logo.png" type="image/png">
  <link rel="stylesheet" href="/stylesheets/viewBill.css">
</head>

<body>
  <%- include('partials/navbar') %>

  <main>
    <div class="no-print-controls">
      <button onclick="window.print()" class="btn btn-print">๐จ๏ธ Print Invoice</button>
      <a href="/sales/history" class="btn btn-back">๐ Back to History</a>
    </div>

    <div class="screen-wrapper">
      <div class="print-area">
        <div class="shop-header">
          <img src="/images/weldon-paints-logo.png" id="logo">
          <div class="shop-name-en">Hamza Weldon Paint & Hardware Store</div>
          <div class="shop-name-ur">
        ุญูุฒ ููฺู ูพููน ุงูฺ ุงุฑฺูุฆุฑ ุณูนูุฑ
      </div>
          <div class="shop-phones">
            <span dir="ltr">0319-9303154</span>(ุญูุฒ)
            <span dir="ltr">0332-9780911</span>(ุงุณูุงุนู)
            <span dir="ltr">0335-0502041</span>(ูุจุงุฑฺฉ ุดุง)
          </div>
        </div>

        <br>

        <p><b>Customer Name:</b> <span><%= bill.customerName %></span></p>
        
        <p class="hide-agent-print"><b>Agent:</b> <%= bill.agentId ? bill.agentId.name : 'Direct Sale' %></p>
        
        <p><b>Entry Date:</b> 
            <%= new Date(bill.createdAt).toLocaleDateString('en-GB', {timeZone: 'Asia/Karachi'}) %> | 
            <%= new Date(bill.createdAt).toLocaleTimeString('en-US', {timeZone: 'Asia/Karachi', hour:'2-digit', minute:'2-digit', hour12:true}) %>
        </p>

        <h3 id="remarks">Remarks:</h3>

        <table>
          <thead>
            <tr>
              <th style="width: 15%;">Stock ID</th>
              <th style="width: 15%;">Sale ID</th>
              <th style="width: 20%;">Item</th>
              <th style="width: 15%;">Color</th>
              <th style="width: 10%;">Unit</th>
              <th style="width: 5%;">Qty</th>
              <th style="width: 10%;">Price</th>
              <th style="width: 10%;">Total</th>
            </tr>
          </thead>
          <tbody>
            <% bill.salesItems.forEach(item => { %>
            <tr>
              <td><%= item.stockID %></td>
              <td><%= item.saleID %></td>
              <td><%= item.itemName %></td>
              <td><%= item.colourName %></td>
              <td><%= item.qty %></td>
              <td><%= item.quantitySold %></td>
              <td><%= item.rate.toFixed(0) %></td>
              <td><%= (item.quantitySold * item.rate).toFixed(0) %></td>
            </tr>
            <% }) %>
          </tbody>
        </table>

        <div class="footer">
          <span>Items: <%= bill.salesItems.length %></span>
          <span>Total: Rs <%= totalAmount.toFixed(0) %></span>
        </div>

        <div class="urdu-footer">
          ูพุช: ููฺฉ ุชุงุฌ ูุงุฑฺฉูนุ ุฏฺฉุงู ููุจุฑ 5ุ6 ฺฉูุงูน ุจูุฑฺ ุงุฆ ู ฺูฺฉ
        </div>

        <div class="urdu-warning">.ุจู ฺฉ ุจุบุฑ ูุงูพุณ ูฺบ ูฺฏ</div>
        <div class="thank-you-section">THANK YOU FOR VISITING HAMZA PAINTS</div>

        <div class="dev-footer">
          <span>Software Developed by: M.SHOUKAT (0335 8004900)</span>
        </div>
      </div>
    </div>
  </main>
</body>

</html>